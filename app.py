import streamlit as st
from docxtpl import DocxTemplate
from datetime import datetime
import io

# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏´‡∏•‡∏±‡∏Å
st.set_page_config(page_title="‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏° ‡∏™‡∏†.‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏ç‡πâ‡∏≤‡πÑ‡∏ã", page_icon="üëÆ‚Äç‚ôÇÔ∏è", layout="wide")

# ==========================================
# üß† ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏π‡πâ‡∏ô‡∏¥‡∏£‡∏†‡∏±‡∏¢‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Data Store)
# ==========================================
# ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏Å‡∏•‡∏≤‡∏á 'data' ‡πÑ‡∏ß‡πâ‡πÄ‡∏Å‡πá‡∏ö‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
if 'data' not in st.session_state:
    st.session_state['data'] = {
        # --- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏° (Drug) ---
        'd_rec_date': datetime.now(),
        'd_rec_time': datetime.now(),
        'd_arr_date': datetime.now(),
        'd_arr_time': datetime.now(),
        'd_loc': "‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ... ‡∏´‡∏°‡∏π‡πà ... ‡∏ï. ... ‡∏≠. ... ‡∏à. ...",
        'd_name': "‡∏ô‡∏≤‡∏¢‡∏Ç‡∏à‡∏£‡∏¢‡∏® ‡∏û‡πà‡∏ß‡∏á‡∏û‡∏á‡∏©‡πå‡∏î‡∏µ",
        'd_age': 29,
        'd_id': "-",
        'd_phone': "-",
        'd_addr': "...",
        'd_evidence': "‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡πÉ‡∏´‡πâ‡πÇ‡∏ó‡∏©‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó 1...",
        'd_amount': "2 ‡πÄ‡∏°‡πá‡∏î",
        'd_pack': "‡∏ñ‡∏∏‡∏á‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å‡πÉ‡∏™...",
        'd_charge': "‡∏°‡∏µ‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡πÉ‡∏´‡πâ‡πÇ‡∏ó‡∏©‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó 1...",
        'd_evt_loc': "...",
        'd_evt_date': datetime.now(),
        'd_evt_time': datetime.now(),
        'd_s_start': datetime.now(),
        'd_s_end': datetime.now(),
        'd_s_res': "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡πà‡∏á‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏î",
        'd_behavior': "‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏ä‡∏∏‡∏î‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°...",
        'd_rank_acc': "‡∏£.‡∏ï.‡∏ï.",
        'd_name_acc': "‡∏≠‡∏≥‡∏ô‡∏≤‡∏à ‡∏Ç‡∏±‡∏ô‡∏ó‡∏™‡∏¥‡∏Å‡∏£‡∏£‡∏°",
        'd_pos_acc': "‡∏£‡∏≠‡∏á ‡∏™‡∏ß(‡∏õ.)‡∏™‡∏†.‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏ç‡πâ‡∏≤‡πÑ‡∏ã",
        'd_team': "‡∏û.‡∏ï.‡∏ó. ...",
        'd_rec': "‡∏Å‡∏©‡∏¥‡∏î‡∏¥‡∏® ‡∏ó‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡∏ß",
        
        # --- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏£‡∏ß‡∏à‡∏â‡∏µ‡πà (Urine) ---
        'u_rec_date': datetime.now(),
        'u_rec_time': datetime.now(),
        'u_loc': "‡∏™‡∏†.‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏ç‡πâ‡∏≤‡πÑ‡∏ã...",
        'u_name': "‡∏ô‡∏≤‡∏¢‡∏ä‡∏ß‡∏Å‡∏£ ‡∏®‡∏£‡∏µ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡πå",
        'u_age': 22,
        'u_id': "1-xxxx-xxxxx-xx-x",
        'u_addr': "...",
        'u_rank1': "‡∏£.‡∏ï.‡∏ó.",
        'u_name1': "‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£ ‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡πÇ‡∏û‡∏ò‡∏¥‡πå‡∏ó‡∏≠‡∏á",
        'u_drug_type': "‡πÄ‡∏°‡∏ó‡πÅ‡∏≠‡∏°‡πÄ‡∏ü‡∏ï‡∏≤‡∏°‡∏µ‡∏ô (‡∏¢‡∏≤‡∏ö‡πâ‡∏≤)",
        'u_other_kit': "",
        'u_result': "‡∏ú‡∏•‡∏ö‡∏ß‡∏Å (‡∏û‡∏ö‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î)",
        'u_rank2': "‡∏£.‡∏ï.‡∏ï.",
        'u_name2': "‡∏≠‡∏≥‡∏ô‡∏≤‡∏à ‡∏Ç‡∏±‡∏ô‡∏ó‡∏™‡∏¥‡∏Å‡∏£‡∏£‡∏°"
    }

# ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏¢‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÜ
D = st.session_state['data']

# ==========================================
# üñ•Ô∏è ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
# ==========================================

st.sidebar.title("üëÆ‚Äç‚ôÇÔ∏è ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°")
menu = st.sidebar.radio(
    "‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°:",
    ["1. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°", 
     "2. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞", 
     "3. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏° (‡πÄ‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Ç‡∏±‡∏ö - ‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ)"]
)
st.sidebar.info("‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢: ‡∏á‡∏≤‡∏ô‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏õ‡∏£‡∏≤‡∏ö‡∏õ‡∏£‡∏≤‡∏° ‡∏™‡∏†.‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏ç‡πâ‡∏≤‡πÑ‡∏ã")

# ==========================================
# üî¥ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà 1: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°
# ==========================================
if menu == "1. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°":
    st.header("üíä ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°")
    
    with st.expander("1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°", expanded=True):
        c1, c2 = st.columns(2)
        D['d_rec_date'] = c1.date_input("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å", value=D['d_rec_date'])
        D['d_rec_time'] = c2.time_input("‡πÄ‡∏ß‡∏•‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (‡∏ô.)", value=D['d_rec_time'])
        c3, c4 = st.columns(2)
        D['d_arr_date'] = c3.date_input("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°", value=D['d_arr_date'])
        D['d_arr_time'] = c4.time_input("‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏° (‡∏ô.)", value=D['d_arr_time'])
        D['d_loc'] = st.text_area("‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°", value=D['d_loc'])

    with st.expander("2. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤", expanded=True):
        c1, c2 = st.columns([2, 1])
        D['d_name'] = c1.text_input("‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤", value=D['d_name'])
        D['d_age'] = c2.number_input("‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏õ‡∏µ)", 15, 100, value=D['d_age'])
        c3, c4 = st.columns(2)
        D['d_id'] = c3.text_input("‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô", value=D['d_id'])
        D['d_phone'] = c4.text_input("‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå", value=D['d_phone'])
        D['d_addr'] = st.text_area("‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≤‡∏°‡∏†‡∏π‡∏°‡∏¥‡∏•‡∏≥‡πÄ‡∏ô‡∏≤", value=D['d_addr'])

    # ‡∏õ‡∏∏‡πà‡∏°‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    if st.button("üíæ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ -> ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞"):
        D['u_name'] = D['d_name']
        D['u_age'] = D['d_age']
        D['u_id'] = D['d_id']
        D['u_addr'] = D['d_addr']
        st.success(f"‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• '{D['d_name']}' ‡πÑ‡∏õ‡∏£‡∏≠‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞‡πÅ‡∏•‡πâ‡∏ß!")

    with st.expander("3. ‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏´‡∏≤", expanded=True):
        D['d_evidence'] = st.text_area("‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á", value=D['d_evidence'])
        ce1, ce2 = st.columns(2)
        D['d_amount'] = ce1.text_input("‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á", value=D['d_amount'])
        D['d_pack'] = ce2.text_input("‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô", value=D['d_pack'])
        D['d_charge'] = st.text_area("‡∏Ç‡πâ‡∏≠‡∏´‡∏≤", value=D['d_charge'])

# --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏î‡∏µ ---
    with st.expander("4. ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏î‡∏µ", expanded=True):
        D['d_evt_loc'] = st.text_area("‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏", value=D['d_evt_loc'])
        b_col1, b_col2 = st.columns(2)
        D['d_evt_date'] = b_col1.date_input("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏", value=D['d_evt_date'])
        D['d_evt_time'] = b_col2.time_input("‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏ (‡∏ô.)", value=D['d_evt_time'])
        st.markdown("---")
        sc1, sc2 = st.columns(2)
        D['d_s_start'] = sc1.time_input("‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô (‡∏ô.)", value=D['d_s_start'])
        D['d_s_end'] = sc2.time_input("‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô (‡∏ô.)", value=D['d_s_end'])
        D['d_s_res'] = st.text_input("‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô", value=D['d_s_res'])
        
        st.markdown("---")
        st.write("üìù **‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ì‡πå (Template ‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏™‡∏à‡∏£‡∏¥‡∏á):**")
        
# --- ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Template ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ì‡πå ---
        story_option = st.selectbox(
            "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ì‡πå (‡∏â‡∏ö‡∏±‡∏ö‡πÄ‡∏ï‡πá‡∏°‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö):",
            ["(‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á)", 
             "1. ‡∏à‡∏±‡∏ö‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î (‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô/‡∏Ñ‡πâ‡∏ô‡∏ï‡∏±‡∏ß/‡∏Ñ‡πâ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô)", 
             "2. ‡∏à‡∏±‡∏ö‡∏≠‡∏≤‡∏ß‡∏∏‡∏ò‡∏õ‡∏∑‡∏ô (‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô/‡∏Ñ‡πâ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô)",
             "3. ‡∏à‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏û (‡∏Ñ‡πâ‡∏ô‡∏ï‡∏±‡∏ß‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠‡∏Ç‡∏≠‡∏á/‡∏â‡∏µ‡πà‡∏°‡πà‡∏ß‡∏á)"]
        )
        
        if st.button("vv ‡πÅ‡∏ó‡∏£‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ (‡∏â‡∏ö‡∏±‡∏ö‡πÄ‡∏ï‡πá‡∏°) vv"):
            
            # --- ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 1: ‡∏à‡∏±‡∏ö‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î (‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô - ‡∏≠‡∏¥‡∏á‡πÄ‡∏Ñ‡∏™‡∏ô‡∏≤‡∏¢‡∏ò‡∏ô‡∏≤‡∏ß‡∏∏‡∏í‡∏¥/‡∏ì‡∏£‡∏á‡∏Ñ‡πå‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå) ---
            if "1." in story_option:
                text = (
                    f"‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏ä‡∏∏‡∏î‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°‡∏î‡∏±‡∏á‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏≤‡∏¢‡∏•‡∏±‡∏ö (‡∏Ç‡∏≠‡∏™‡∏á‡∏ß‡∏ô‡∏ô‡∏≤‡∏°) ‡∏ß‡πà‡∏≤‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì {D['d_evt_loc']} ‡∏°‡∏µ‡∏ß‡∏±‡∏¢‡∏£‡∏∏‡πà‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏°‡∏±‡πà‡∏ß‡∏™‡∏∏‡∏°‡πÄ‡∏™‡∏û‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏ä‡∏∏‡∏î‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°‡∏à‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏≤‡∏ó‡∏£‡∏≤‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏≤‡∏à‡∏≤ ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏≤‡πÑ‡∏î‡πâ‡∏™‡∏±‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏ä‡∏∏‡∏î‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡πÇ‡∏î‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏Å‡∏£‡∏á‡∏ß‡πà‡∏≤‡∏ñ‡πâ‡∏≤‡∏´‡∏≤‡∏Å‡πÄ‡∏ô‡∏¥‡πà‡∏ô‡∏ä‡πâ‡∏≤‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÑ‡∏õ‡∏Ç‡∏≠‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡πâ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏à‡∏≤‡∏Å‡∏®‡∏≤‡∏•‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ô‡∏Å‡∏≤‡∏£ ‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡πÇ‡∏¢‡∏Å‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡∏à‡∏≤‡∏Å‡∏à‡∏∏‡∏î‡∏ã‡πà‡∏≠‡∏ô ‡∏à‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö"
                    "\n\n"
                    f"‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡πâ‡∏≤‡∏ô‡∏û‡∏±‡∏Å‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏û‡∏ö {D['d_name']} (‡∏ó‡∏£‡∏≤‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á) ‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡πÑ‡∏î‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á‡∏°‡∏µ‡∏û‡∏¥‡∏£‡∏∏‡∏ò ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏à‡∏∞‡∏´‡∏•‡∏ö‡∏´‡∏ô‡∏µ ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏à‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ï‡∏±‡∏ß {D['d_name']} ‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡πÅ‡∏•‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‡∏õ.‡∏õ.‡∏™. ‡πÅ‡∏•‡∏∞‡∏à‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏° {D['d_name']} ‡∏ß‡πà‡∏≤‡πÄ‡∏™‡∏û‡∏¢‡∏≤‡∏ö‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà {D['d_name']} ‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡∏ï‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏™‡∏û‡∏¢‡∏≤‡∏ö‡πâ‡∏≤‡∏à‡∏£‡∏¥‡∏á ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏à‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡∏ï‡∏±‡∏ß ‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡πÑ‡∏î‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏£‡∏¥‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏´‡πâ {D['d_name']} ‡∏î‡∏π‡∏à‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏≠‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß"
                    "\n\n"
                    f"‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡∏ï‡∏±‡∏ß‡∏û‡∏ö {D['d_evidence']} ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô {D['d_amount']} ‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô{D['d_pack']} ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á/‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏™‡∏∞‡∏û‡∏≤‡∏¢ ‡∏ó‡∏µ‡πà {D['d_name']} ‡∏™‡∏ß‡∏°‡πÉ‡∏™‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô ‡πÇ‡∏î‡∏¢ {D['d_name']} ‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡∏à‡∏£‡∏¥‡∏á ‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡πÄ‡∏à‡∏≠‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏ô‡∏à‡∏£‡∏¥‡∏á"
                    "\n\n"
                    f"‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏° {D['d_name']} ‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏ô‡πÄ‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á ‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏¢‡∏≤‡∏ö‡πâ‡∏≤‡∏°‡∏≤‡∏à‡∏≤‡∏Å (‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢) ‡πÇ‡∏î‡∏¢‡∏ã‡∏∑‡πâ‡∏≠‡∏¢‡∏≤‡∏ö‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏°‡πá‡∏î‡∏•‡∏∞ (‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏Ñ‡∏≤) ‡∏ö‡∏≤‡∏ó ‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏™‡∏û‡∏¢‡∏≤‡∏ö‡πâ‡∏≤‡∏°‡∏≤‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠ (‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤) ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏£‡∏∞‡∏ö‡∏∏) ‡πÄ‡∏°‡πá‡∏î ‡∏ó‡∏µ‡πà‡∏Ç‡πâ‡∏≤‡∏Ø {D['d_name']} ‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏Å‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏°‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£ ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏à‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ï‡∏±‡∏ß‡∏°‡∏≤‡∏¢‡∏±‡∏á ‡∏™‡∏†.‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏ç‡πâ‡∏≤‡πÑ‡∏ã ‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞‡∏Ç‡∏≠‡∏á {D['d_name']} ‡∏™‡πà‡∏á‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏ç‡πâ‡∏≤‡πÑ‡∏ã ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î"
                )
                D['d_behavior'] = text

            # --- ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 2: ‡∏à‡∏±‡∏ö‡∏≠‡∏≤‡∏ß‡∏∏‡∏ò‡∏õ‡∏∑‡∏ô (‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô - ‡∏≠‡∏¥‡∏á‡πÄ‡∏Ñ‡∏™ ‡∏ô.‡∏™.‡∏î‡∏≤‡∏ß) ---
            elif "2." in story_option:
                text = (
                    f"‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏ä‡∏∏‡∏î‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°‡∏î‡∏±‡∏á‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏≤‡∏¢‡∏•‡∏±‡∏ö (‡∏Ç‡∏≠‡∏™‡∏á‡∏ß‡∏ô‡∏ô‡∏≤‡∏°) ‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà {D['d_evt_loc']} ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏°‡∏±‡πà‡∏ß‡∏™‡∏∏‡∏°‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏≠‡∏≤‡∏ß‡∏∏‡∏ò‡∏õ‡∏∑‡∏ô‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏ä‡∏∏‡∏î‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°‡∏à‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏≤‡∏ó‡∏£‡∏≤‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏≤‡∏à‡∏≤ ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏≤‡πÑ‡∏î‡πâ‡∏™‡∏±‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏ä‡∏∏‡∏î‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡πÇ‡∏î‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏Å‡∏£‡∏á‡∏ß‡πà‡∏≤‡∏ñ‡πâ‡∏≤‡∏´‡∏≤‡∏Å‡πÄ‡∏ô‡∏¥‡πà‡∏ô‡∏ä‡πâ‡∏≤‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÑ‡∏õ‡∏Ç‡∏≠‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡πâ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏à‡∏≤‡∏Å‡∏®‡∏≤‡∏•‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ô‡∏Å‡∏≤‡∏£ ‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡πÇ‡∏¢‡∏Å‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡∏à‡∏≤‡∏Å‡∏à‡∏∏‡∏î‡∏ã‡πà‡∏≠‡∏ô ‡∏à‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö"
                    "\n\n"
                    f"‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡∏û‡∏ö‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß {D['d_name']} (‡∏ó‡∏£‡∏≤‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á) ‡∏¢‡∏∑‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡πâ‡∏≤‡∏ô/‡πÄ‡∏û‡∏¥‡∏á‡∏û‡∏±‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡πÑ‡∏î‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á‡∏°‡∏µ‡∏û‡∏¥‡∏£‡∏∏‡∏ò‡∏°‡∏µ‡πÄ‡∏´‡∏ï‡∏∏‡∏≠‡∏±‡∏ô‡∏Ñ‡∏ß‡∏£‡∏™‡∏á‡∏™‡∏±‡∏¢ ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏à‡∏∂‡∏á‡πÑ‡∏î‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡∏ï‡∏±‡∏ß {D['d_name']} ‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡πÑ‡∏î‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏£‡∏¥‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏à‡πÉ‡∏´‡πâ {D['d_name']} ‡∏î‡∏π‡∏à‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏≠‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡∏ï‡∏±‡∏ß‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏î"
                    "\n\n"
                    f"‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ä‡∏∏‡∏î‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏û‡∏¥‡∏á‡∏û‡∏±‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ó‡∏µ‡πà {D['d_name']} ‡∏û‡∏±‡∏Å‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏≠‡∏á‡∏à‡∏∞‡∏°‡∏µ‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ã‡∏∏‡∏Å‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡∏à‡∏∂‡∏á‡∏Ç‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô ‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡πÑ‡∏î‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏£‡∏¥‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏à‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏à‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏≠‡πÉ‡∏à ‡πÅ‡∏•‡∏∞ {D['d_name']} ‡πÑ‡∏î‡πâ‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÉ‡∏à‡πÉ‡∏´‡πâ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡∏û‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡πÄ‡∏û‡∏¥‡∏á‡∏û‡∏±‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß"
                    "\n\n"
                    f"‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏û‡∏ö {D['d_evidence']} ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô {D['d_amount']} ‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö‡∏ß‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏≠‡∏ô/‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏≠‡∏ô ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏û‡∏¥‡∏á‡∏û‡∏±‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏±‡∏á‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß ‡πÇ‡∏î‡∏¢ {D['d_name']} ‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡∏≠‡∏≤‡∏ß‡∏∏‡∏ò‡∏õ‡∏∑‡∏ô‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏ô‡πÄ‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á (‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÅ‡∏ï‡πà‡∏ï‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏≠‡∏á) ‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡∏ï‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏°‡∏µ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏≠‡∏≤‡∏ß‡∏∏‡∏ò‡∏õ‡∏∑‡∏ô‡∏à‡∏≤‡∏Å‡∏ô‡∏≤‡∏¢‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏≤‡∏ß‡∏∏‡∏ò‡∏õ‡∏∑‡∏ô‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏î ‡∏à‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ï‡∏±‡∏ß‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏™‡πà‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏≠‡∏ö‡∏™‡∏ß‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Ñ‡∏î‡∏µ‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢"
                )
                D['d_behavior'] = text

            # --- ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 3: ‡∏à‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏û (‡∏≠‡∏¥‡∏á‡πÄ‡∏Ñ‡∏™‡∏ô‡∏≤‡∏¢‡∏Å‡∏§‡∏©‡∏é‡∏≤/‡∏ß‡∏¥‡∏ä‡∏∏‡∏î‡∏≤) ---
            elif "3." in story_option:
                text = (
                    f"‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏ä‡∏∏‡∏î‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°‡πÑ‡∏î‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏´‡∏ï‡∏∏ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì {D['d_evt_loc']} ‡∏û‡∏ö {D['d_name']} (‡∏ó‡∏£‡∏≤‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á) ‡∏¢‡∏∑‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á‡∏°‡∏µ‡∏û‡∏¥‡∏£‡∏∏‡∏ò‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Ñ‡∏ô‡πÄ‡∏™‡∏û‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏à‡∏∂‡∏á‡πÑ‡∏î‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‡∏õ.‡∏õ.‡∏™. ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡∏ï‡∏±‡∏ß {D['d_name']}"
                    "\n\n"
                    f"‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡∏ï‡∏±‡∏ß ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡πÑ‡∏î‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏£‡∏¥‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏´‡πâ {D['d_name']} ‡∏î‡∏π‡∏à‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏≠‡πÉ‡∏à ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏° {D['d_name']} ‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏™‡∏û‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà {D['d_name']} ‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡∏ï‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏™‡∏û‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡∏à‡∏£‡∏¥‡∏á ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏ä‡∏∏‡∏î‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°‡∏à‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡∏∏‡∏î‡∏ï‡∏£‡∏ß‡∏à GPO Meth Cassette ‡∏ä‡∏ô‡∏¥‡∏î‡∏ï‡∏•‡∏±‡∏ö ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡πÉ‡∏ô‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏•‡∏ö‡∏ß‡∏Å"
                    "\n\n"
                    f"‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏° {D['d_name']} ‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏™‡∏û‡∏¢‡∏≤‡∏ö‡πâ‡∏≤‡∏°‡∏≤‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠ (‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤) ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏£‡∏∞‡∏ö‡∏∏) ‡πÄ‡∏°‡πá‡∏î ‡πÇ‡∏î‡∏¢‡∏ã‡∏∑‡πâ‡∏≠‡∏¢‡∏≤‡∏ö‡πâ‡∏≤‡∏°‡∏≤‡∏à‡∏≤‡∏Å (‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢) ‡πÉ‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏°‡πá‡∏î‡∏•‡∏∞ (‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏Ñ‡∏≤) ‡∏ö‡∏≤‡∏ó ‡∏ó‡∏µ‡πà‡∏Ç‡πâ‡∏≤‡∏Ø {D['d_name']} ‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏Å‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏°‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£ ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏à‡∏∂‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏ä‡∏¥‡∏ç‡∏ï‡∏±‡∏ß {D['d_name']} ‡∏°‡∏≤‡∏¢‡∏±‡∏á ‡∏™‡∏†.‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏ç‡πâ‡∏≤‡πÑ‡∏ã ‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞‡∏™‡πà‡∏á‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏ç‡πâ‡∏≤‡πÑ‡∏ã ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î"
                )
                D['d_behavior'] = text
            
            st.rerun()
# --- üî• ‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏î‡∏á (‡πÉ‡∏™‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ!) ---
        st.markdown("""
            <div style="background-color: #ffe6e6; padding: 10px; border-radius: 5px; border-left: 5px solid #ff4b4b; margin-bottom: 10px;">
                <h4 style="color: #ff4b4b; margin:0;">üö® ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</h4>
                <p style="color: #cc0000; font-weight: bold; font-size: 16px; margin:0;">
                    1.‡∏´‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏î‡∏µ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î <br>
                    ‡πÉ‡∏´‡πâ‡∏ó‡πà‡∏≤‡∏ô‡∏•‡∏ö‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤ <u>"‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÉ‡∏à‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡∏´‡∏≤‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡πÉ‡∏ô‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞..."</u> 
                    ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Word ‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á!<br>
                    2.‡∏ó‡πà‡∏≤‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Word ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î <br>
                    ‡∏´‡∏≤‡∏Å‡∏ó‡πà‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö <u>"‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏õ‡∏£‡∏±‡∏ö‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢"</u> 
                </p>
            </div>
        """, unsafe_allow_html=True)
        
        D['d_behavior'] = st.text_area("‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÑ‡∏î‡πâ):", value=D['d_behavior'], height=350)
    with st.expander("5. ‡∏ä‡∏∏‡∏î‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏° & ‡∏ú‡∏π‡πâ‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏´‡∏≤", expanded=True):
        ac1, ac2, ac3 = st.columns([1, 2, 2])
        D['d_rank_acc'] = ac1.text_input("‡∏¢‡∏® (‡∏ú‡∏π‡πâ‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏´‡∏≤)", value=D['d_rank_acc'])
        D['d_name_acc'] = ac2.text_input("‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• (‡∏ú‡∏π‡πâ‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏´‡∏≤)", value=D['d_name_acc'])
        D['d_pos_acc'] = ac3.text_input("‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á", value=D['d_pos_acc'])
        D['d_team'] = st.text_area("‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà (‡πÅ‡∏õ‡∏∞‡∏ó‡πâ‡∏≤‡∏¢)", value=D['d_team'])
        D['d_rec'] = st.text_input("‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• (‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å/‡∏≠‡πà‡∏≤‡∏ô)", value=D['d_rec'])

    if st.button("üñ®Ô∏è ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏° (Word)"):
        try:
            doc = DocxTemplate("arrest_template.docx")
            
            thai_months = ["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå", "‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°", "‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô", "‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°", "‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô", 
                           "‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°", "‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô", "‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°", "‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô", "‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"]
            
            def get_thai_date(d_obj):
                return f"{d_obj.day} {thai_months[d_obj.month - 1]} {d_obj.year + 543}"

            context = {
                'record_date': get_thai_date(D['d_rec_date']),
                'record_time': D['d_rec_time'].strftime("%H:%M"),
                'arrest_date': get_thai_date(D['d_arr_date']),
                'arrest_time': D['d_arr_time'].strftime("%H:%M"),
                'location': D['d_loc'], 'suspect_name': D['d_name'], 'age': D['d_age'],
                'id_card': D['d_id'], 'address': D['d_addr'],
                'evidence': D['d_evidence'], 'amount': D['d_amount'], 'packaging': D['d_pack'],
                'charge': D['d_charge'], 'event_location': D['d_evt_loc'],
                'behavior_date': get_thai_date(D['d_evt_date']),
                'behavior_time': D['d_evt_time'].strftime("%H:%M"),
                'search_start': D['d_s_start'].strftime("%H:%M"),
                'search_end': D['d_s_end'].strftime("%H:%M"),
                'search_result': D['d_s_res'],
                'behavior_body': D['d_behavior'],
                'accuser_rank': D['d_rank_acc'], 'accuser_name': D['d_name_acc'], 'accuser_pos': D['d_pos_acc'],
                'police_team': D['d_team'], 'name_rec': D['d_rec']
            }
            doc.render(context)
            bio = io.BytesIO()
            doc.save(bio)
            st.download_button("‚¨áÔ∏è ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î", bio.getvalue(), f"‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏°_{D['d_name']}.docx", "application/vnd.openxmlformats-officedocument.wordprocessingml.document")
        except Exception as e:
            st.error(f"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: {e}")


# ==========================================
# üü° ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà 2: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞
# ==========================================
elif menu == "2. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞":
    st.header("üß™ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞")
    
    if st.button("üì• ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î"):
        st.rerun()

    with st.expander("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à", expanded=True):
        c1, c2 = st.columns(2)
        D['u_rec_date'] = c1.date_input("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à", value=D['u_rec_date'])
        D['u_rec_time'] = c2.time_input("‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞ (‡∏ô.)", value=D['u_rec_time'])
        D['u_loc'] = st.text_area("‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à", value=D['u_loc'])
        
        c3, c4 = st.columns([2, 1])
        D['u_name'] = c3.text_input("‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à", value=D['u_name'])
        D['u_age'] = c4.number_input("‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏õ‡∏µ)", 15, 100, value=D['u_age'])
        D['u_id'] = st.text_input("‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô", value=D['u_id'])
        D['u_addr'] = st.text_area("‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô", value=D['u_addr'])

    with st.expander("‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å & ‡∏ú‡∏•‡∏ï‡∏£‡∏ß‡∏à", expanded=True):
        c_r1, c_r2 = st.columns([1, 3])
        D['u_rank1'] = c_r1.text_input("‡∏¢‡∏® (‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å)", value=D['u_rank1'])
        D['u_name1'] = c_r2.text_input("‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• (‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å)", value=D['u_name1'])
        
        st.write("---")
        drug_options = ["‡πÄ‡∏°‡∏ó‡πÅ‡∏≠‡∏°‡πÄ‡∏ü‡∏ï‡∏≤‡∏°‡∏µ‡∏ô (‡∏¢‡∏≤‡∏ö‡πâ‡∏≤)", "‡∏Å‡∏±‡∏ç‡∏ä‡∏≤", "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"]
        try:
            idx = drug_options.index(D['u_drug_type'])
        except:
            idx = 0
        D['u_drug_type'] = st.radio("‡∏ä‡∏ô‡∏¥‡∏î‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î", drug_options, index=idx)
        
        if D['u_drug_type'] == "‡∏≠‡∏∑‡πà‡∏ô‡πÜ":
            D['u_other_kit'] = st.text_input("‡∏£‡∏∞‡∏ö‡∏∏ (‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∑‡πà‡∏ô‡πÜ)", value=D['u_other_kit'])
        
        result_options = ["‡∏ú‡∏•‡∏•‡∏ö (‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏≤‡∏£)", "‡∏ú‡∏•‡∏ö‡∏ß‡∏Å (‡∏û‡∏ö‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î)"]
        try:
            idx_res = result_options.index(D['u_result'])
        except:
            idx_res = 1
        D['u_result'] = st.radio("‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à", result_options, index=idx_res)
        
        st.write("---")
        c_r3, c_r4 = st.columns([1, 3])
        D['u_rank2'] = c_r3.text_input("‡∏¢‡∏® (‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢)", value=D['u_rank2'])
        D['u_name2'] = c_r4.text_input("‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• (‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢)", value=D['u_name2'])

    if st.button("üñ®Ô∏è ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡∏â‡∏µ‡πà (Word)"):
        try:
            doc = DocxTemplate("template_urine.docx")
            
            thai_months = ["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå", "‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°", "‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô", "‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°", "‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô", 
                           "‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°", "‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô", "‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°", "‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô", "‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"]
            d = D['u_rec_date'].day
            m = thai_months[D['u_rec_date'].month - 1]
            y = D['u_rec_date'].year + 543
            date_thai = f"{d}  ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô  {m}  ‡∏û.‡∏®.  {y}"
            
            CHECK = "/"
            context = {
                'location': D['u_loc'], 'date_thai': date_thai, 'time': D['u_rec_time'].strftime("%H:%M"),
                'suspect_name': D['u_name'], 'age': D['u_age'], 'id_card': D['u_id'], 'address': D['u_addr'],
                'rank_1': D['u_rank1'], 'name_1': D['u_name1'],
                'c_meth': CHECK if D['u_drug_type'] == "‡πÄ‡∏°‡∏ó‡πÅ‡∏≠‡∏°‡πÄ‡∏ü‡∏ï‡∏≤‡∏°‡∏µ‡∏ô (‡∏¢‡∏≤‡∏ö‡πâ‡∏≤)" else " ",
                'c_weed': CHECK if D['u_drug_type'] == "‡∏Å‡∏±‡∏ç‡∏ä‡∏≤" else " ",
                'c_other': CHECK if D['u_drug_type'] == "‡∏≠‡∏∑‡πà‡∏ô‡πÜ" else " ",
                'other_kit': D['u_other_kit'],
                'r_neg': CHECK if "‡∏ú‡∏•‡∏•‡∏ö" in D['u_result'] else " ",
                'r_pos': CHECK if "‡∏ú‡∏•‡∏ö‡∏ß‡∏Å" in D['u_result'] else " ",
                'rank_2': D['u_rank2'], 'name_2': D['u_name2']
            }
            doc.render(context)
            bio = io.BytesIO()
            doc.save(bio)
            st.download_button("‚¨áÔ∏è ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î", bio.getvalue(), f"‡∏ï‡∏£‡∏ß‡∏à‡∏â‡∏µ‡πà_{D['u_name']}.docx", "application/vnd.openxmlformats-officedocument.wordprocessingml.document")
        except Exception as e:
            st.error(f"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: {e}")

# ==========================================
# üü° ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà 3: (‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡∏£‡∏≠‡∏ó‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°)
# ==========================================
elif menu == "3. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏±‡∏ö‡∏Å‡∏∏‡∏° (‡πÄ‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Ç‡∏±‡∏ö - ‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ)":
    st.warning("üöß ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á... ‡∏£‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ï‡∏≠‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ")